<%# locals: article, formatted (optional) %>
<%= link_to article_path(article), class: "block rounded-2xl overflow-hidden bg-white shadow hover:shadow-lg transition" do %>
  <div class="aspect-[16/9] bg-gray-100">
    <% if article.article_image.present? %>
      <%= image_tag article.article_image, alt: article.title, class: "h-full w-full object-cover" %>
    <% else %>
      <div class="h-full w-full grid place-items-center text-gray-400">
        No image
      </div>
    <% end %>
  </div>

  <div class="p-5">
    <%# Category + date %>
    <div class="mb-2 flex items-center gap-2 text-sm text-gray-500">
      <span class="inline-flex items-center rounded-full bg-gray-100 px-2.5 py-0.5 text-xs font-medium text-gray-700">
        <%= article.category.presence || "Uncategorized" %>
      </span>
      <span aria-hidden="true">Â·</span>
      <time datetime="<%= article.publish_date %>">
        <%= l(article.publish_date, format: :long) rescue article.publish_date %>
      </time>
    </div>

    <h3 class="text-lg font-semibold leading-snug text-gray-900 line-clamp-2">
      <% if local_assigns[:formatted]&.dig("title") %>
        <%= raw formatted["title"] %>   <%# highlight-aware %>
      <% else %>
        <%= article.title %>
      <% end %>
    </h3>

    <p class="mt-2 text-gray-600 line-clamp-3">
      <% if local_assigns[:formatted]&.dig("excerpt") %>
        <%= raw formatted["excerpt"] %> <%# highlight-aware %>
      <% else %>
        <%= article.excerpt %>
      <% end %>
    </p>

    <div class="mt-4 text-sm text-gray-500">
      <%= t(".by", default: "by") %> <span class="font-medium text-gray-700"><%= article.author %></span>
    </div>
  </div>
<% end %>
